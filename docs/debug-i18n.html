<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>i18n è°ƒè¯•é¡µé¢</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 1200px; margin: 0 auto; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .section h2 { margin-top: 0; color: #333; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
        pre { background: #f5f5f5; padding: 10px; border-radius: 3px; overflow-x: auto; }
        .success { color: green; }
        .error { color: red; }
        .warning { color: orange; }
    </style>
</head>
<body>
    <h1>ğŸ” all-tools.html i18n è°ƒè¯•å·¥å…·</h1>
    
    <div class="section">
        <h2>1. è¯­è¨€åˆ‡æ¢æµ‹è¯•</h2>
        <button onclick="testLanguage('zh-CN')">æµ‹è¯•ä¸­æ–‡</button>
        <button onclick="testLanguage('en')">æµ‹è¯•è‹±æ–‡</button>
        <button onclick="testLanguage('ja')">æµ‹è¯•æ—¥æ–‡</button>
        <button onclick="testLanguage('ko')">æµ‹è¯•éŸ©æ–‡</button>
        <div id="lang-result"></div>
    </div>
    
    <div class="section">
        <h2>2. ç¿»è¯‘æ–‡ä»¶æ£€æŸ¥</h2>
        <button onclick="checkTranslationFiles()">æ£€æŸ¥æ‰€æœ‰ç¿»è¯‘æ–‡ä»¶</button>
        <div id="file-result"></div>
    </div>
    
    <div class="section">
        <h2>3. å½“å‰çŠ¶æ€</h2>
        <button onclick="showCurrentState()">æ˜¾ç¤ºå½“å‰çŠ¶æ€</button>
        <button onclick="clearStorage()">æ¸…é™¤ localStorage</button>
        <div id="state-result"></div>
    </div>
    
    <div class="section">
        <h2>4. æ‰“å¼€æµ‹è¯•é¡µé¢</h2>
        <a href="./pages/all-tools.html" target="_blank">
            <button>åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€ all-tools.html</button>
        </a>
    </div>

    <script src="./data/tools.js"></script>
    <script src="./assets/js/i18n.js"></script>
    <script>
        async function testLanguage(lang) {
            const result = document.getElementById('lang-result');
            result.innerHTML = `<p>æ­£åœ¨æµ‹è¯• ${lang}...</p>`;
            
            try {
                // åŠ è½½ç¿»è¯‘æ–‡ä»¶
                const response = await fetch(`./i18n/all-tools/${lang}.json`);
                if (!response.ok) {
                    result.innerHTML = `<p class="error">âŒ ç¿»è¯‘æ–‡ä»¶ä¸å­˜åœ¨: ./i18n/all-tools/${lang}.json</p>`;
                    return;
                }
                
                const translations = await response.json();
                
                // æ˜¾ç¤ºç¿»è¯‘å†…å®¹
                let html = `<p class="success">âœ… ç¿»è¯‘æ–‡ä»¶åŠ è½½æˆåŠŸ</p>`;
                html += `<h3>ç¿»è¯‘å†…å®¹é¢„è§ˆï¼š</h3>`;
                html += `<pre>${JSON.stringify(translations, null, 2).substring(0, 1000)}...</pre>`;
                
                // æ£€æŸ¥å…³é”®å­—æ®µ
                html += `<h3>å…³é”®å­—æ®µæ£€æŸ¥ï¼š</h3>`;
                html += `<ul>`;
                html += `<li>meta.title: ${translations.meta?.title ? 'âœ…' : 'âŒ'}</li>`;
                html += `<li>page.subtitle: ${translations.page?.subtitle ? 'âœ…' : 'âŒ'}</li>`;
                html += `<li>search.placeholder: ${translations.search?.placeholder ? 'âœ…' : 'âŒ'}</li>`;
                html += `<li>categories: ${translations.categories ? 'âœ…' : 'âŒ'}</li>`;
                html += `<li>toolsData: ${translations.toolsData ? 'âœ…' : 'âŒ'}</li>`;
                html += `</ul>`;
                
                result.innerHTML = html;
            } catch (error) {
                result.innerHTML = `<p class="error">âŒ é”™è¯¯: ${error.message}</p>`;
            }
        }
        
        async function checkTranslationFiles() {
            const result = document.getElementById('file-result');
            result.innerHTML = `<p>æ­£åœ¨æ£€æŸ¥ç¿»è¯‘æ–‡ä»¶...</p>`;
            
            const languages = ['zh-CN', 'en', 'ja', 'ko'];
            let html = '<ul>';
            
            for (const lang of languages) {
                try {
                    const response = await fetch(`./i18n/all-tools/${lang}.json`);
                    if (response.ok) {
                        const data = await response.json();
                        const toolCount = Object.keys(data.toolsData || {}).length;
                        html += `<li class="success">âœ… ${lang}.json - ${toolCount} ä¸ªå·¥å…·ç¿»è¯‘</li>`;
                    } else {
                        html += `<li class="error">âŒ ${lang}.json - æ–‡ä»¶ä¸å­˜åœ¨</li>`;
                    }
                } catch (error) {
                    html += `<li class="error">âŒ ${lang}.json - åŠ è½½å¤±è´¥: ${error.message}</li>`;
                }
            }
            
            html += '</ul>';
            result.innerHTML = html;
        }
        
        function showCurrentState() {
            const result = document.getElementById('state-result');
            
            let html = '<h3>å…¨å±€å˜é‡çŠ¶æ€ï¼š</h3>';
            html += `<ul>`;
            html += `<li>window.currentLang: ${window.currentLang || 'æœªå®šä¹‰'}</li>`;
            html += `<li>window.translations: ${window.translations ? 'å·²å®šä¹‰' : 'æœªå®šä¹‰'}</li>`;
            html += `<li>window.LANGUAGES: ${window.LANGUAGES ? 'å·²å®šä¹‰' : 'æœªå®šä¹‰'}</li>`;
            html += `<li>localStorage.lang: <strong>${localStorage.getItem('lang') || 'æœªè®¾ç½®'}</strong></li>`;
            html += `</ul>`;
            
            html += '<h3>toolsData çŠ¶æ€ï¼š</h3>';
            html += `<ul>`;
            html += `<li>toolsData: ${typeof toolsData !== 'undefined' ? 'å·²å®šä¹‰' : 'æœªå®šä¹‰'}</li>`;
            if (typeof toolsData !== 'undefined') {
                html += `<li>categories: ${toolsData.categories ? 'å·²å®šä¹‰' : 'æœªå®šä¹‰'}</li>`;
                if (toolsData.categories) {
                    html += `<li>åˆ†ç±»æ•°é‡: ${Object.keys(toolsData.categories).length}</li>`;
                    html += `<li>åˆ†ç±»åˆ—è¡¨: ${Object.keys(toolsData.categories).join(', ')}</li>`;
                }
            }
            html += `</ul>`;
            
            html += '<h3>å·²åŠ è½½çš„ç¿»è¯‘ï¼š</h3>';
            if (window.translations) {
                html += `<ul>`;
                for (const lang in window.translations) {
                    html += `<li>${lang}: ${Object.keys(window.translations[lang]).join(', ')}</li>`;
                }
                html += `</ul>`;
            } else {
                html += `<p class="warning">âš ï¸ æ²¡æœ‰å·²åŠ è½½çš„ç¿»è¯‘</p>`;
            }
            
            result.innerHTML = html;
        }
        
        function clearStorage() {
            localStorage.removeItem('lang');
            alert('âœ… localStorage å·²æ¸…é™¤ï¼\n\nè¯·åˆ·æ–°é¡µé¢æµ‹è¯•é»˜è®¤è¯­è¨€æ£€æµ‹ã€‚');
            showCurrentState();
        }
        
        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºå½“å‰çŠ¶æ€
        window.addEventListener('load', () => {
            setTimeout(showCurrentState, 1000);
        });
    </script>
</body>
</html>
