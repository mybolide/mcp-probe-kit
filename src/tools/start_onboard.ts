/**
 * start_onboard æ™ºèƒ½ç¼–æ’å·¥å…·
 * 
 * åœºæ™¯ï¼šå¿«é€Ÿä¸Šæ‰‹é¡¹ç›®
 * ç¼–æ’ï¼šanalyze_project â†’ init_project_context
 */

const PROMPT_TEMPLATE = `# ğŸ“š å¿«é€Ÿä¸Šæ‰‹ç¼–æ’æŒ‡å—

## ğŸ¯ ç›®æ ‡

å¿«é€Ÿäº†è§£å¹¶ä¸Šæ‰‹å½“å‰é¡¹ç›®

---

## ğŸ” æ­¥éª¤ 1: é¡¹ç›®åˆ†æ

**è°ƒç”¨å·¥å…·**: \`analyze_project\`

**å‚æ•°**:
\`\`\`json
{
  "project_path": "{project_path}",
  "max_depth": 5,
  "include_content": true
}
\`\`\`

**åˆ†æå†…å®¹**:
- é¡¹ç›®ç»“æ„
- æŠ€æœ¯æ ˆè¯†åˆ«
- å…¥å£æ–‡ä»¶
- æ ¸å¿ƒæ¨¡å—
- ä¾èµ–å…³ç³»

**äº§å‡º**: é¡¹ç›®åˆ†ææŠ¥å‘Š

---

## ğŸ“ æ­¥éª¤ 2: ç”Ÿæˆé¡¹ç›®ä¸Šä¸‹æ–‡

**è°ƒç”¨å·¥å…·**: \`init_project_context\`

**å‚æ•°**:
\`\`\`json
{
  "docs_dir": "{docs_dir}"
}
\`\`\`

**ç”Ÿæˆå†…å®¹**:
- æŠ€æœ¯æ ˆæ–‡æ¡£
- æ¶æ„è¯´æ˜
- ç¼–ç è§„èŒƒ
- å¼€å‘æŒ‡å—

**äº§å‡º**: \`{docs_dir}/project-context.md\`

---

## âœ… å®Œæˆæ£€æŸ¥

- [ ] é¡¹ç›®ç»“æ„å·²åˆ†æ
- [ ] æŠ€æœ¯æ ˆå·²è¯†åˆ«
- [ ] é¡¹ç›®ä¸Šä¸‹æ–‡å·²ç”Ÿæˆ
- [ ] æ–‡æ¡£å·²ä¿å­˜

---

## ğŸ“Š è¾“å‡ºæ±‡æ€»

å®Œæˆåï¼Œå‘ç”¨æˆ·æä¾›ï¼š

### 1. é¡¹ç›®æ¦‚è§ˆ

| é¡¹ç›® | å†…å®¹ |
|------|------|
| é¡¹ç›®åç§° | [åç§°] |
| é¡¹ç›®ç±»å‹ | [å‰ç«¯/åç«¯/å…¨æ ˆ/åº“] |
| ä¸»è¦è¯­è¨€ | [è¯­è¨€] |
| æ¡†æ¶ | [æ¡†æ¶] |

### 2. æŠ€æœ¯æ ˆ

| ç±»åˆ« | æŠ€æœ¯ |
|------|------|
| è¯­è¨€ | [è¯­è¨€åˆ—è¡¨] |
| æ¡†æ¶ | [æ¡†æ¶åˆ—è¡¨] |
| æ„å»ºå·¥å…· | [å·¥å…·åˆ—è¡¨] |
| æµ‹è¯•æ¡†æ¶ | [æ¡†æ¶åˆ—è¡¨] |

### 3. é¡¹ç›®ç»“æ„

\`\`\`
[ç›®å½•æ ‘]
\`\`\`

### 4. æ ¸å¿ƒæ–‡ä»¶

| æ–‡ä»¶ | ç”¨é€” |
|------|------|
| [æ–‡ä»¶1] | [ç”¨é€”] |
| [æ–‡ä»¶2] | [ç”¨é€”] |

### 5. å¿«é€Ÿå¼€å§‹

\`\`\`bash
# å®‰è£…ä¾èµ–
[å®‰è£…å‘½ä»¤]

# å¯åŠ¨å¼€å‘
[å¯åŠ¨å‘½ä»¤]

# è¿è¡Œæµ‹è¯•
[æµ‹è¯•å‘½ä»¤]
\`\`\`

### 6. ä¸‹ä¸€æ­¥å»ºè®®

1. é˜…è¯» \`{docs_dir}/project-context.md\` äº†è§£è¯¦ç»†ä¿¡æ¯
2. æŸ¥çœ‹ README.md äº†è§£é¡¹ç›®èƒŒæ™¯
3. è¿è¡Œé¡¹ç›®ç†Ÿæ‚‰åŠŸèƒ½
4. é˜…è¯»æ ¸å¿ƒæ¨¡å—ä»£ç 

---

*ç¼–æ’å·¥å…·: MCP Probe Kit - start_onboard*
`;

export async function startOnboard(args: any) {
  try {
    const projectPath = args?.project_path || ".";
    const docsDir = args?.docs_dir || "docs";

    const guide = PROMPT_TEMPLATE
      .replace(/{project_path}/g, projectPath)
      .replace(/{docs_dir}/g, docsDir);

    return {
      content: [{ type: "text", text: guide }],
    };
  } catch (error) {
    const errorMsg = error instanceof Error ? error.message : String(error);
    return {
      content: [{ type: "text", text: `âŒ ç¼–æ’æ‰§è¡Œå¤±è´¥: ${errorMsg}` }],
      isError: true,
    };
  }
}
