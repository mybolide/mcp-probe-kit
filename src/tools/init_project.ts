// init_project å·¥å…·å®ç°
export async function initProject(args: any) {
  try {
    const input = args?.input || "";
    const projectName = args?.project_name || "æ–°é¡¹ç›®";

    const message = `ä½ éœ€è¦æŒ‰ç…§ Spec-Driven Developmentï¼ˆè§„èŒƒé©±åŠ¨å¼€å‘ï¼‰çš„æ–¹å¼åˆå§‹åŒ–é¡¹ç›®ï¼Œå‚è€ƒ https://github.com/github/spec-kit çš„å·¥ä½œæµç¨‹ã€‚

ğŸ“‹ **é¡¹ç›®éœ€æ±‚**ï¼š
${input}

ğŸ¯ **åˆå§‹åŒ–æ­¥éª¤**ï¼š

**ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºé¡¹ç›®åŸºç¡€ç»“æ„**
åœ¨å½“å‰å·¥ä½œåŒºåˆ›å»ºä»¥ä¸‹ç›®å½•å’Œæ–‡ä»¶ï¼š

\`\`\`
.
â”œâ”€â”€ memory/
â”‚   â””â”€â”€ constitution.md    # é¡¹ç›®å®ªæ³•ï¼ˆæ ¸å¿ƒåŸåˆ™å’Œçº¦æŸï¼‰
â”œâ”€â”€ specs/
â”‚   â””â”€â”€ 001-${projectName.toLowerCase().replace(/\s+/g, '-')}/
â”‚       â”œâ”€â”€ spec.md        # åŠŸèƒ½è§„æ ¼è¯´æ˜
â”‚       â”œâ”€â”€ plan.md        # å®ç°è®¡åˆ’
â”‚       â”œâ”€â”€ tasks.md       # ä»»åŠ¡åˆ†è§£
â”‚       â””â”€â”€ research.md    # æŠ€æœ¯è°ƒç ”
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ check-prerequisites.sh
â”‚   â””â”€â”€ setup.sh
â””â”€â”€ templates/
    â”œâ”€â”€ spec-template.md
    â”œâ”€â”€ plan-template.md
    â””â”€â”€ tasks-template.md
\`\`\`

**ç¬¬äºŒæ­¥ï¼šç”Ÿæˆ constitution.md**
åœ¨ \`memory/constitution.md\` ä¸­å®šä¹‰é¡¹ç›®çš„æ ¸å¿ƒåŸåˆ™ï¼ŒåŒ…æ‹¬ï¼š
- ä»£ç é£æ ¼è§„èŒƒ
- æ¶æ„åŸåˆ™
- å®‰å…¨å‡†åˆ™
- æµ‹è¯•è¦æ±‚
- æ–‡æ¡£æ ‡å‡†

**ç¬¬ä¸‰æ­¥ï¼šç”Ÿæˆ spec.mdï¼ˆåŠŸèƒ½è§„æ ¼ï¼‰**
åœ¨ \`specs/001-${projectName.toLowerCase().replace(/\s+/g, '-')}/spec.md\` ä¸­è¯¦ç»†æè¿°ï¼š
- é¡¹ç›®èƒŒæ™¯å’Œç›®æ ‡
- ç”¨æˆ·æ•…äº‹ï¼ˆUser Storiesï¼‰
- åŠŸèƒ½éœ€æ±‚
- éåŠŸèƒ½éœ€æ±‚
- çº¦æŸæ¡ä»¶
- éªŒæ”¶æ ‡å‡†

**ç¬¬å››æ­¥ï¼šç”Ÿæˆ plan.mdï¼ˆå®ç°è®¡åˆ’ï¼‰**
åˆ†æéœ€æ±‚å¹¶ç”Ÿæˆå®ç°è®¡åˆ’ï¼ŒåŒ…æ‹¬ï¼š
- æŠ€æœ¯æ ˆé€‰æ‹©ï¼ˆæ¡†æ¶ã€æ•°æ®åº“ã€éƒ¨ç½²æ–¹å¼ç­‰ï¼‰
- ç³»ç»Ÿæ¶æ„è®¾è®¡
- æ¨¡å—åˆ’åˆ†
- æ•°æ®æ¨¡å‹è®¾è®¡
- API è®¾è®¡
- å…³é”®æŠ€æœ¯å†³ç­–

**ç¬¬äº”æ­¥ï¼šç”Ÿæˆ research.mdï¼ˆæŠ€æœ¯è°ƒç ”ï¼‰**
å¯¹é€‰å®šçš„æŠ€æœ¯æ ˆè¿›è¡Œè°ƒç ”ï¼š
- ç¡®è®¤ç‰ˆæœ¬å…¼å®¹æ€§
- è¯†åˆ«æ½œåœ¨é£é™©
- è®°å½•æœ€ä½³å®è·µ
- åˆ—å‡ºå‚è€ƒæ–‡æ¡£

**ç¬¬å…­æ­¥ï¼šç”Ÿæˆ tasks.mdï¼ˆä»»åŠ¡åˆ†è§£ï¼‰**
å°†å®ç°è®¡åˆ’åˆ†è§£ä¸ºå¯æ‰§è¡Œçš„ä»»åŠ¡ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š
\`\`\`markdown
# ä»»åŠ¡åˆ†è§£

## é˜¶æ®µ 1ï¼šé¡¹ç›®åˆå§‹åŒ–
- [ ] Task 1.1: æ­å»ºé¡¹ç›®éª¨æ¶ (æ–‡ä»¶: ./setup.sh)
- [ ] Task 1.2: é…ç½®å¼€å‘ç¯å¢ƒ (æ–‡ä»¶: ./devcontainer.json)
- [ ] Task 1.3: [P] åˆå§‹åŒ–æ•°æ®åº“ (æ–‡ä»¶: ./database/schema.sql)

## é˜¶æ®µ 2ï¼šæ ¸å¿ƒåŠŸèƒ½å®ç°
- [ ] Task 2.1: å®ç°æ•°æ®æ¨¡å‹ (æ–‡ä»¶: ./src/models/)
- [ ] Task 2.2: [P] å®ç°ç”¨æˆ·è®¤è¯ (æ–‡ä»¶: ./src/auth/)
- [ ] Task 2.3: [P] å®ç°ä¸šåŠ¡é€»è¾‘ (æ–‡ä»¶: ./src/services/)
  ä¾èµ–: Task 2.1

## é˜¶æ®µ 3ï¼šAPI å¼€å‘
- [ ] Task 3.1: åˆ›å»º REST API (æ–‡ä»¶: ./src/api/)
  ä¾èµ–: Task 2.2, Task 2.3
- [ ] Task 3.2: [P] ç¼–å†™ API æµ‹è¯• (æ–‡ä»¶: ./tests/api/)

## é˜¶æ®µ 4ï¼šå‰ç«¯å¼€å‘
- [ ] Task 4.1: æ­å»ºå‰ç«¯æ¡†æ¶ (æ–‡ä»¶: ./frontend/)
- [ ] Task 4.2: [P] å®ç° UI ç»„ä»¶ (æ–‡ä»¶: ./frontend/components/)
- [ ] Task 4.3: [P] é›†æˆ API (æ–‡ä»¶: ./frontend/services/)
  ä¾èµ–: Task 3.1

## é˜¶æ®µ 5ï¼šæµ‹è¯•ä¸éƒ¨ç½²
- [ ] Task 5.1: é›†æˆæµ‹è¯• (æ–‡ä»¶: ./tests/integration/)
- [ ] Task 5.2: æ€§èƒ½æµ‹è¯• (æ–‡ä»¶: ./tests/performance/)
- [ ] Task 5.3: éƒ¨ç½²é…ç½® (æ–‡ä»¶: ./deploy/)

---
**æ ‡è®°è¯´æ˜**ï¼š
- [P]: å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„ä»»åŠ¡
- ä¾èµ–: å¿…é¡»åœ¨æŒ‡å®šä»»åŠ¡å®Œæˆåæ‰èƒ½å¼€å§‹
\`\`\`

**ç¬¬ä¸ƒæ­¥ï¼šç”Ÿæˆè¾…åŠ©è„šæœ¬**
åˆ›å»ºé¡¹ç›®ç®¡ç†è„šæœ¬ï¼š
- \`scripts/check-prerequisites.sh\`: æ£€æŸ¥ç¯å¢ƒä¾èµ–
- \`scripts/setup.sh\`: è‡ªåŠ¨åŒ–é¡¹ç›®åˆå§‹åŒ–
- \`scripts/create-new-feature.sh\`: åˆ›å»ºæ–°åŠŸèƒ½åˆ†æ”¯

ğŸ“ **æ³¨æ„äº‹é¡¹**ï¼š
1. æ‰€æœ‰æ–‡ä»¶ä½¿ç”¨ Markdown æ ¼å¼ï¼Œä¿æŒæ¸…æ™°çš„ç»“æ„
2. éµå¾ªé¡¹ç›® constitution ä¸­å®šä¹‰çš„åŸåˆ™
3. ä»»åŠ¡åˆ†è§£è¦è¶³å¤Ÿç»†è‡´ï¼Œæ¯ä¸ªä»»åŠ¡åº”è¯¥åœ¨ 2-4 å°æ—¶å†…å®Œæˆ
4. æ ‡è®°æ¸…æ¥šä»»åŠ¡ä¹‹é—´çš„ä¾èµ–å…³ç³»
5. è¯†åˆ«å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„ä»»åŠ¡ä»¥ä¼˜åŒ–å¼€å‘æ•ˆç‡

ğŸš€ **å¼€å§‹æ‰§è¡Œ**ï¼š
ç°åœ¨è¯·æŒ‰ç…§ä¸Šè¿°æ­¥éª¤åˆ›å»ºé¡¹ç›®ç»“æ„å’Œæ‰€æœ‰å¿…éœ€çš„æ–‡æ¡£ã€‚`;

    return {
      content: [
        {
          type: "text",
          text: message,
        },
      ],
    };
  } catch (error) {
    const errorMessage =
      error instanceof Error ? error.message : String(error);
    return {
      content: [
        {
          type: "text",
          text: `âŒ åˆå§‹åŒ–é¡¹ç›®å¤±è´¥: ${errorMessage}`,
        },
      ],
      isError: true,
    };
  }
}

